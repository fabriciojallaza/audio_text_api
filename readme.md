# Django API for audio-to-text transcription using the Deepgram API

###### Django API for audio-to-text transcription using the Deepgram API

This project is a simple API that transcribes an audio file into text using the Deepgram API. The project is built using Django, Django Rest Framework and the DRF_YASG library for API documentation.
## Installation & Run

### Install requirements for Linux
It requires Python 3.7 or higher

~~~bash
sudo apt update
sudo apt-get install python3-pip
sudo pip3 install virtualenv
sudo apt-get install git-all
sudo apt-get install sqlite3
~~~

### Install requirements for Windows
It requires Python 3.7 or higher

~~~bash
# Descargar e instalar Python 3.7 o superior
https://www.python.org/downloads/
# Descargar e instalar Git
https://git-scm.com/downloads
# Descargar e instalar pip
curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py
python get-pip.py
# Instalar virtualenv
pip install virtualenv
~~~

### Clone the repository

~~~bash
# Mediante protocolo https
git clone https://github.com/fabriciojallaza/audio_text_api
~~~

### Create virtualenv

~~~bash
python3 -m virtualenv venv
~~~

### Activate virtualenv

~~~bash
# For python >=3.10
source venv/local/bin/activate
# For python <3.10
source venv/bin/activate
~~~

### Install dependencies


#### Install requirements for virtualenv

~~~bash
pip install -r requirements.txt
~~~

### Save DEEPGRAM_API_KEY in environment variable
To save the DEEPGRAM_API_KEY in an environment variable, you can use the following command in a Unix-based terminal:

~~~bash 
export DEEPGRAM_API_KEY=your_api_key_here
~~~
Make sure to replace your_api_key_here with your actual API key.

Alternatively, you can add this line to your shell startup script (e.g. ~/.bashrc) to automatically set the environment variable every time you open a new terminal session.


#### To Run Tests

~~~bash
python manage.py test
~~~

#### Run server

~~~bash
python manage.py runserver

# API Endpoint : http://127.0.0.1:8000
~~~

## Structure

```
.
├── audio_text_api
│   ├── __init__.py
│   ├── asgi.py
│   ├── settings.py
│   ├── urls.py
│   └── wsgi.py
├── transcription
│   ├── lib
│   │   └── audio_transcription.py
│   ├── __init__.py
│   ├── admin.py
│   ├── apps.py
│   ├── models.py
│   ├── tests.py
│   ├── urls.py
│   └── views.py
├── db.sqlite3
├── manage.py
├── requirements.txt
└── user

2 directories, 13 files
```

## API
Documentation for the API can be found under the following links (autogenerated by swagger python plugin):
* Swager UI: http://127.0.0.1:8000/api/v1/docs/
* Redoc: http://127.0.0.1:8000/api/v1/redoc/

![Swagger](https://github.com/fabriciojallaza/audio_text_api/blob/3849394e743ea9bb02ba134586e7a05e717566c3/transcription/utils/swagger.png)  

To Test the API follow the instructions in the end of this document.

### /v1/transcribe/audio-to-text
* **POST**: Send Audio or Audio URL to transcribe to text

## Architecture Design
The project follows a standard Model-View-Controller (MVC) architecture pattern.

### Models
The models are defined in the `models.py` file and are responsible for managing the data of the application. In this project, we have defined two models, File and Transcription.

`File` model stores the metadata related to the uploaded files, including the file name, file size, upload time, and the user who uploaded the file.

`Transcription` model stores the transcribed text and the time it was created. It has a foreign key relationship with the File model, indicating that each transcription corresponds to a specific file.

### Views
The views are defined in the `views.py` file and handle user input and responses. Views in this project are responsible for rendering the HTML templates, handling file uploads, and displaying transcriptions.

The `FileUploadView` is responsible for handling the file upload functionality. It receives the uploaded file, saves it to the server, and creates a new File object with the metadata.

The `TranscriptionView` is responsible for handling the transcription functionality. It receives the file ID of the uploaded file, calls the audio_transcription function from the audio_transcription.py module to transcribe the audio file, and creates a new Transcription object with the transcribed text.

### Controllers
The controller in this project is represented by the `urls.py` file, which maps URLs to views. Each URL pattern is associated with a view function that will handle the request.

Other Modules
The `audio_transcription.py` module provides the function audio_transcription, which uses the Deepgram Speech-to-Text API to transcribe the audio file.

Overall, the architecture of this project is designed to be scalable and maintainable. By separating concerns into models, views, and controllers, we can easily modify and extend the functionality of the application without affecting other parts of the code. Additionally, the use of external APIs in the `audio_transcription.py` module allows for the integration of additional features in the future.